generator client {
    provider = "prisma-client-js"
    engineType = "library"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum Role {
    ADMIN
    VOLUNTEER
}

model User {
    id       Int     @id @default(autoincrement())
    name     String
    email    String  @unique
    password String
    role     Role
    verified Boolean

    sessions Session[]
}

model Session {
    id        String   @id
    userId    Int
    expiresAt DateTime
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Patient {
    id          String @id
    cardNumber  Int    @default(autoincrement())
    name        String
    age         Int
    phoneNumber String
    cnic        String
    comments    String

    // added two fields 
    isBlocked          Boolean  @default(false)
    currentCycleVisits Int  @default(0)

    dateLastVisited DateTime
    visits          Visit[]
}

model Visit {
    id        Int      @id @default(autoincrement())
    patient   Patient  @relation(fields: [patientId], references: [id])
    patientId String
    dateTime  DateTime
}
